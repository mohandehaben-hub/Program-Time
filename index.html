<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„ØªÙ‡Ø§Ù…ÙŠ Ù„Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø£Ù…Ù†ÙŠØ© | Live Time Sync</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { 
            --primary: #020617; 
            --accent: #f59e0b;
            --text-light: #f8fafc; 
            --glass: rgba(15, 23, 42, 0.85);
            --glass-border: rgba(245, 158, 11, 0.4);
        }

        body { 
            font-family: 'Segoe UI', Tahoma, sans-serif; 
            background: radial-gradient(circle at center, #1e293b 0%, #020617 100%);
            color: var(--text-light);
            margin: 0;
            min-height: 100vh;
            padding: 15px;
        }

        .container { max-width: 450px; margin: 0 auto; }

        .header-card { 
            background: var(--glass); 
            backdrop-filter: blur(15px);
            padding: 20px; border-radius: 25px; 
            text-align: center; border: 1px solid var(--glass-border);
            margin-bottom: 20px;
        }

        .profile-img { 
            width: 70px; height: 70px; border-radius: 50%; 
            border: 2px solid var(--accent); margin-bottom: 10px;
        }

        .box { 
            background: var(--glass); 
            padding: 18px; border-radius: 25px; 
            margin-bottom: 15px; border: 1px solid rgba(255,255,255,0.1);
        }

        .live-clock-box {
            background: rgba(245, 158, 11, 0.1);
            border: 1px dashed var(--accent);
            border-radius: 15px;
            padding: 10px;
            margin-bottom: 15px;
            text-align: center;
        }

        #liveClock {
            font-family: 'Courier New', Courier, monospace;
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent);
        }

        label { color: var(--accent); font-weight: bold; display: block; margin-bottom: 10px; font-size: 0.85rem; }

        .input-group { display: flex; gap: 5px; margin-bottom: 15px; }

        select { 
            flex: 1; padding: 12px 2px; border-radius: 12px; 
            background: #000; color: #fff; border: 1px solid rgba(255,255,255,0.2);
            text-align: center; font-size: 0.85rem; cursor: pointer;
        }

        select:focus { border-color: var(--accent); outline: none; }

        .btn-calc { 
            background: linear-gradient(90deg, var(--accent), #d97706); 
            color: #000; width: 100%; 
            padding: 16px; border: none; border-radius: 15px; 
            font-weight: 900; cursor: pointer; font-size: 1rem;
            transition: 0.3s; margin-top: 10px;
        }

        .btn-calc:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(245, 158, 11, 0.4); }

        .result-box { 
            display: none; background: #fff; 
            color: #000; padding: 20px; 
            border-radius: 20px; margin-top: 15px; text-align: center;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn { from {opacity: 0;} to {opacity: 1;} }

        .target-time { font-size: 2.2rem; font-weight: 900; color: #020617; }

        .dev-signature { 
            font-size: 0.7rem; color: var(--accent); text-align: center; 
            margin-top: 20px; opacity: 0.7; line-height: 1.5;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header-card">
        <img src="https://i.ibb.co/Y78PM4nn/me-jpg.jpg" class="profile-img">
        <div style="font-weight: 800; color: var(--accent); font-size: 1.1rem;">Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ Ù…Ù‡Ù†Ø¯ Ø¥ÙŠÙ‡Ø§Ø¨ Ø§Ù„ØªÙ‡Ø§Ù…ÙŠ</div>
        <div style="font-size: 0.75rem; opacity: 0.8;">Ø®Ø¨ÙŠØ± ØªØ·ÙˆÙŠØ± Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø£Ù…Ù†ÙŠØ© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</div>
    </div>

    <div class="box">
        <div class="live-clock-box">
            <div style="font-size: 0.7rem; margin-bottom: 5px; color: #fff;">Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ø§Ù„Ø¢Ù† (Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„)</div>
            <div id="liveClock">00:00:00</div>
            <div id="liveDate" style="font-size: 0.8rem; color: #fff; margin-top: 5px;"></div>
        </div>

        <label><i class="fas fa-video"></i> ÙˆÙ‚Øª Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ (DVR) Ø§Ù„Ø¸Ø§Ù‡Ø± Ø§Ù„Ø¢Ù†:</label>
        <div class="input-group" id="camNowGroup"></div>
        <p style="font-size: 0.7rem; color: #cbd5e1; margin-top: -10px;">* Ø§Ø¶Ø¨Ø· Ù‡Ø°Ø§ Ø§Ù„ÙˆÙ‚Øª Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù…Ø§ ØªØ±Ø§Ù‡ ÙÙŠ Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¢Ù†.</p>
    </div>

    <div class="box">
        <label style="color: #fbbf24;"><i class="fas fa-search"></i> ÙˆÙ‚Øª Ø§Ù„ÙˆØ§Ù‚Ø¹Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ ØªÙØ±ÙŠØºÙ‡Ø§ (ÙˆÙ‚Øª Ø­Ù‚ÙŠÙ‚ÙŠ):</label>
        <div class="input-group" id="targetRealGroup"></div>

        <button class="btn-calc" onclick="calculateDVRTime()">
            <i class="fas fa-sync-alt"></i> Ø§Ø³ØªØ®Ø±Ø§Ø¬ ØªÙˆÙ‚ÙŠØª Ø§Ù„Ø¨Ø­Ø«
        </button>
    </div>

    <div id="result" class="result-box">
        <div style="font-size: 0.9rem; font-weight: bold;">ğŸ¯ Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ Ø¬Ù‡Ø§Ø² Ø§Ù„Ù€ DVR ÙˆØ§Ø¨Ø­Ø« ÙÙŠ:</div>
        <div id="resTime" class="target-time"></div>
        <div id="resDate" style="font-weight: bold; color: #020617; font-size: 1.1rem;"></div>
        <div style="font-size: 0.75rem; margin-top: 10px; color: #475569;">(ØªÙ… Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ ÙØ±Ù‚ Ø§Ù„ØªÙˆÙ‚ÙŠØª Ø§Ù„Ù„Ø­Ø¸ÙŠ)</div>
    </div>

    <div class="dev-signature">
        Eagle Vision Logic - Secure Systems <br>
        Developed by: Eng. Mohannad El-Tohamy
    </div>
</div>

<script>
    let currentRealDate = new Date();

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø§Ø¹Ø© Ø§Ù„Ø­ÙŠØ©
    function updateLiveClock() {
        currentRealDate = new Date();
        const h = String(currentRealDate.getHours()).padStart(2, '0');
        const m = String(currentRealDate.getMinutes()).padStart(2, '0');
        const s = String(currentRealDate.getSeconds()).padStart(2, '0');
        document.getElementById('liveClock').innerText = `${h}:${m}:${s}`;
        
        const options = { day: 'numeric', month: 'long', year: 'numeric' };
        document.getElementById('liveDate').innerText = currentRealDate.toLocaleDateString('ar-EG', options);
    }
    setInterval(updateLiveClock, 1000);

    // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù…
    function createSelectors(idPrefix, isTarget = false) {
        const now = new Date();
        const days = Array.from({length: 31}, (_, i) => i + 1);
        const months = Array.from({length: 12}, (_, i) => i + 1);
        const hours = Array.from({length: 24}, (_, i) => i);
        const mins = Array.from({length: 60}, (_, i) => i);

        // Ù„Ùˆ ÙƒØ§Ù† ÙˆÙ‚Øª Ø§Ù„ÙˆØ§Ù‚Ø¹Ø©ØŒ Ù†Ø®Ù„ÙŠÙ‡ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ ÙŠØ±Ø¬Ø¹ Ù„ÙŠÙˆÙ… Ø³Ø§Ø¨Ù‚ Ø¹Ø´Ø§Ù† ÙŠØ³Ù‡Ù„ Ø¹Ù„ÙŠÙƒ
        const defaultDay = isTarget ? now.getDate() : now.getDate();

        return `
            <select id="${idPrefix}D">${days.map(d => `<option value="${d}" ${d==defaultDay?'selected':''}>${d}</option>`).join('')}</select>
            <select id="${idPrefix}M">${months.map(m => `<option value="${m-1}" ${m-1==now.getMonth()?'selected':''}>${m}</option>`).join('')}</select>
            <select id="${idPrefix}H">${hours.map(h => `<option value="${h}" ${h==now.getHours()?'selected':''}>${String(h).padStart(2,'0')}</option>`).join('')}</select>
            <select id="${idPrefix}Min">${mins.map(m => `<option value="${m}" ${m==now.getMinutes()?'selected':''}>${String(m).padStart(2,'0')}</option>`).join('')}</select>
        `;
    }

    window.onload = () => {
        updateLiveClock();
        document.getElementById('camNowGroup').innerHTML = createSelectors('cn');
        document.getElementById('targetRealGroup').innerHTML = createSelectors('tr', true);
    };

    function calculateDVRTime() {
        // 1. Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ø§Ù„Ù„Ø­Ø¸ÙŠ (Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„)
        const realNow = currentRealDate;
        
        // 2. ÙˆÙ‚Øª Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø§Ù„Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¯Ø®Ù„Ù‡ (Ø§Ù„Ø¢Ù†)
        const camNow = new Date(realNow.getFullYear(), getValue('cnM'), getValue('cnD'), getValue('cnH'), getValue('cnMin'));
        
        // 3. ÙˆÙ‚Øª Ø§Ù„ÙˆØ§Ù‚Ø¹Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù†Ù‡
        const targetReal = new Date(realNow.getFullYear(), getValue('trM'), getValue('trD'), getValue('trH'), getValue('trMin'));

        // 4. Ø­Ø³Ø§Ø¨ Ø§Ù„ÙØ¬ÙˆØ© (Offset)
        const offsetMs = realNow - camNow;

        // 5. Ø§Ù„Ù†ØªÙŠØ¬Ø©
        const dvrTarget = new Date(targetReal.getTime() - offsetMs);

        // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¹Ø±Ø¶
        const h = String(dvrTarget.getHours()).padStart(2, '0');
        const m = String(dvrTarget.getMinutes()).padStart(2, '0');
        const s = String(dvrTarget.getSeconds()).padStart(2, '0');
        const day = dvrTarget.getDate();
        const month = dvrTarget.getMonth() + 1;
        const year = dvrTarget.getFullYear();

        document.getElementById('resTime').innerText = `${h}:${m}:${s}`;
        document.getElementById('resDate').innerText = `Ø§Ù„ØªØ§Ø±ÙŠØ®: ${day} / ${month} / ${year}`;
        document.getElementById('result').style.display = 'block';
        document.getElementById('result').scrollIntoView({behavior: 'smooth'});
    }

    function getValue(id) { return parseInt(document.getElementById(id).value); }
</script>

</body>
</html>
